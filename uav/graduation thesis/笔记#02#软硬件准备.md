## 一、飞控软硬件体系简介

![xxx](https://img2020.cnblogs.com/i-beta/1042431/202003/1042431-20200315142850670-1720294772.png)

　　Pixhawk是我们地面站开发过程中的主角。它是一款开源的无人机飞控硬件。飞控是一架无人机的核心组件，相当于无人机的“大脑”，是一种能控制无人机自主或半自主飞行的控制系统。总之，该硬件是完成我们后续工作的基础。它将作为我们调试地面站的数据来源。其外观如上图所示。

　　在这款硬件之上我们可以运行两套软件体系，一套是Pixhawk的PX4原生固件。所谓固件，类似于操作系统之于电脑主机。另外一套叫做APM固件（或者叫ArduPilot固件）。这两款软件体系的相关源代码都是完全开源的，都可以在代码管理平台GitHub上找到。它们的代码的体系架构有所不同，维护人员也完全不一样，但核心算法都是一样的。这两款固件分别对应着两款开源无人机地面站，就是之前所介绍的MP以及QGC。倘若Pixhawk安装的是PX4的原生固件，那么一定采用QGC地面站。倘若安装的是APM固件则一定采用MP地面站。这就是它们之间的对应关系。关于上述知识的说明，主要来源于[PX4飞控开发初级教程](https://www.bilibili.com/video/av41124287/)。它是笔者目前在网上看到的最系统详细的中文资料。

　　笔者所开发的地面站选用的Pixhawk硬件具体配置如下：

1. 主处理器：32位STM32F427，主频168 MHz ，256 KB RAM,2 MB Flash
2. 备用处理器：独立供电32位STM32F103故障保护协处理器
3. 传感器：双 3轴加速度计、磁力计、双陀螺仪（测量转速）、气压计（测高）、内置罗盘、支持外置双GPS
4. 集成的备份、超控、故障保险处理器
5. microSD 插槽用于日志等用途, 5个 UARTs, CAN, I2C, SPI, ADC,等

　　另外所需要的配件为一条USB数据线和GPS。前者用于连接飞控与个人电脑以便调试地面站，后者则用于提供无人机飞控的实时位置。

## 二、飞控固件的安装

　　准备好相关硬件后，首先需要进行飞控固件的安装。本地面站采用APM固件，可以自主选择固件的安装方式，但是出于对方便性的考虑，我们通过MP来进行固件的安装以及测试。因此，首先需要下载MP地面站。然后将飞控硬件通过USB数据线连接个人电脑。确保物理连接没问题，飞控板上的指示灯正常亮起。之后，启动MP地面站，通过如下操作，安装APM固件。

　　第一步，选择对应的端口以及波特率，点击“连接”。

![img](https://img2020.cnblogs.com/i-beta/1042431/202003/1042431-20200315144259058-847255276.png)

　　第二步，点击位于MP界面上方的工具栏中的“初始设置”，然后点击“安装固件”，选择需要安装的固件。本地面站开发所采用的固件为“ArduCopter V4.0.0 Quad”。

![img](https://img2020.cnblogs.com/i-beta/1042431/202003/1042431-20200315144607687-360098862.png)

　　最后，按照提示安装好固件。我们返回到“飞行数据”界面。这时，移动你手中的Pixhawk硬件，倘若看到类似下图所示的一些实时变化的飞行数据，就说明固件已经安装成功了。

![img](https://img2020.cnblogs.com/i-beta/1042431/202003/1042431-20200315145023735-1020582342.png)

## 三、应具备的软件开发技能

　　实现一个无人机地面站，光有硬件方面的准备显然是完不成的，我们还需要一些软件开发方面的准备。就笔者个人而言，感到这方面的准备，无论如何要比零基础学习硬件知识要简单得多🙃。一个无人机地面站实际上只做了三件事：接收来自无人机的数据、将数据可视化、发送数据至无人机。为了编程完成这三项工作，本地面站所需的基本软件开发技能如下：

1. 对C#编程、多线程软件开发有一定了解。该技能将用于构建地面站的后端，以便与飞控进行数据交互，并将数据转发至前端。
2. 对WebSocket协议有所了解。该协议将用于支持地面站前后端之间的数据交互。
3. 对前端开发有一定了解（涉及HTML、CSS、JavaScript等）。该技能将用于开发地面站的前端，完成数据可视化的工作。